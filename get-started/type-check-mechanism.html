<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>类型检查机制 | 杉数科技</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/learn-ts-vuepress/assets/favicon.ico">
    <meta name="description" content="Learn TypeScript">
    
    <link rel="preload" href="/learn-ts-vuepress/assets/css/0.styles.334f5f1f.css" as="style"><link rel="preload" href="/learn-ts-vuepress/assets/js/app.e5df6003.js" as="script"><link rel="preload" href="/learn-ts-vuepress/assets/js/2.a63e5f2f.js" as="script"><link rel="preload" href="/learn-ts-vuepress/assets/js/32.fb15d45c.js" as="script"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/10.9202d1d4.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/11.8fda7a7d.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/12.a39fa0c7.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/13.2880b726.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/14.30d0896a.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/15.b6f51370.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/16.4b10d895.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/17.3b9450a7.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/18.e32fdd1e.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/19.336a7f0d.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/20.7c029866.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/21.57c5bdb4.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/22.01900a0d.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/23.df91d9ff.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/24.d430e4b7.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/25.8b32cf34.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/26.73b5d25e.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/27.6c9aa8ae.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/28.fa2f3746.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/29.f228d9c1.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/3.72d6967a.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/30.b27caeba.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/31.eb0d9d9e.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/33.23a4925e.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/34.b04067d0.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/4.d5b262bf.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/5.3e8cb5ce.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/6.78c274dd.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/7.c817e804.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/8.46690339.js"><link rel="prefetch" href="/learn-ts-vuepress/assets/js/9.39525a5f.js">
    <link rel="stylesheet" href="/learn-ts-vuepress/assets/css/0.styles.334f5f1f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-ts-vuepress/" class="home-link router-link-active"><img src="/learn-ts-vuepress/assets/favicon.ico" alt="杉数科技" class="logo"> <span class="site-name can-hide">杉数科技</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-ts-vuepress/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/get-started/" class="nav-link router-link-active">
  入门
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/advance/" class="nav-link">
  高级
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/translate/" class="nav-link">
  翻译
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/framework/" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/front-end/" class="nav-link">
  前端技术
</a></div><div class="nav-item"><a href="https://github.com/condorheroblog/learn-ts-vuepress" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-ts-vuepress/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/get-started/" class="nav-link router-link-active">
  入门
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/advance/" class="nav-link">
  高级
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/translate/" class="nav-link">
  翻译
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/framework/" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/learn-ts-vuepress/front-end/" class="nav-link">
  前端技术
</a></div><div class="nav-item"><a href="https://github.com/condorheroblog/learn-ts-vuepress" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/learn-ts-vuepress/get-started/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基本类型</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-ts-vuepress/get-started/reshape-type-thinking.html" class="sidebar-link">重塑类型思维</a></li><li><a href="/learn-ts-vuepress/get-started/basic-type.html" class="sidebar-link">基本类型</a></li><li><a href="/learn-ts-vuepress/get-started/enums-type.html" class="sidebar-link">枚举</a></li><li><a href="/learn-ts-vuepress/get-started/interface-type.html" class="sidebar-link">接口</a></li><li><a href="/learn-ts-vuepress/get-started/function-type.html" class="sidebar-link">函数</a></li><li><a href="/learn-ts-vuepress/get-started/class-type.html" class="sidebar-link">类</a></li><li><a href="/learn-ts-vuepress/get-started/generic-type.html" class="sidebar-link">泛型</a></li><li><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html" aria-current="page" class="active sidebar-link">类型检查机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#什么是类型检查机制" class="sidebar-link">什么是类型检查机制？</a></li><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#类型检查机制内容" class="sidebar-link">类型检查机制内容</a></li><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#类型推断" class="sidebar-link">类型推断</a></li><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#类型断言" class="sidebar-link">类型断言</a></li><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#类型兼容性" class="sidebar-link">类型兼容性</a></li><li class="sidebar-sub-header"><a href="/learn-ts-vuepress/get-started/type-check-mechanism.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/learn-ts-vuepress/get-started/advance-type.html" class="sidebar-link">高级类型</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="类型检查机制"><a href="#类型检查机制" class="header-anchor">#</a> 类型检查机制</h1> <h2 id="什么是类型检查机制"><a href="#什么是类型检查机制" class="header-anchor">#</a> 什么是类型检查机制？</h2> <p>TypeScript 编译器在做类型检查时，所秉承的一些原则，以及变现出的一些行为，作用是辅助开发者提高开发效率。</p> <h2 id="类型检查机制内容"><a href="#类型检查机制内容" class="header-anchor">#</a> 类型检查机制内容</h2> <p>类型检查机制包括三个部分</p> <ul><li>类型推断</li> <li>类型兼容性</li> <li>类型保护</li></ul> <h2 id="类型推断"><a href="#类型推断" class="header-anchor">#</a> 类型推断</h2> <p>不指定变量的类型（函数返回值的类型），TypeScript 可以根据某些规则自动为其推断出一个类型。</p> <p>类型推断包含三个部分：</p> <ul><li>基础类型推断</li> <li>最佳通用型类型推断</li> <li>上下文类型推断</li></ul> <h3 id="基础类型推断"><a href="#基础类型推断" class="header-anchor">#</a> 基础类型推断</h3> <p>初始化一个变量：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> a<span class="token punctuation">;</span> <span class="token comment">// let a: any</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// let a: number = 10;</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// let arr: any[]</span>
<span class="token keyword">let</span> arrNum <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// let arrNum: number[]</span>
<span class="token keyword">let</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// let func: (x?: number) =&gt; number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="最佳通用型类型推断"><a href="#最佳通用型类型推断" class="header-anchor">#</a> 最佳通用型类型推断</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// let arr: (string | number)[];</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="上下文类型推断"><a href="#上下文类型推断" class="header-anchor">#</a> 上下文类型推断</h3> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>TypeScript 版本要求小于等于 3.5.x 才会有上下文类型推断，大于 3 版本，都已经不支持了，官方最新文档没有更新。</p></div> <p>上面的类型推断方向都是从又往左的，由值推断出类型。上下文类型推断比较特殊，正好反过来。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>mouseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (parameter) mouseEvent: MouseEvent</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mouseEvent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt;- OK</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="类型断言"><a href="#类型断言" class="header-anchor">#</a> 类型断言</h2> <p>有时候你会遇到这样的情况，你会比 TypeScript 更了解某个值的详细信息。<strong>通常这会发生在你清楚地知道一个实体具有比它现有类型更确切的类型。</strong></p> <p>通过类型断言这种方式可以告诉编译器，“相信我，我知道自己在干什么”。 类型断言好比其它语言里的类型转换，但是不进行特殊的数据检查和解构。 它没有运行时的影响，只是在编译阶段起作用。 TypeScript 会假设你，程序员，已经进行了必须的检查。</p> <p>类型断言有两种形式。 其一是「尖括号」语法：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> someValue<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> strLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>someValue<span class="token punctuation">)</span><span class="token punctuation">.</span>length
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>另一个为 <code>as</code> 语法：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> someValue<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> strLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token punctuation">(</span>someValue <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>两种形式是等价的。 至于使用哪个大多数情况下是凭个人喜好；然而，当你在 TypeScript 里使用 JSX 时，只有 <code>as</code> 语法断言是被允许的。</p> <h2 id="类型兼容性"><a href="#类型兼容性" class="header-anchor">#</a> 类型兼容性</h2> <p>当一个类型 Y 可以赋值给另一个类型 X 时， 我们就可以说类型 X 兼容类型 Y。</p> <blockquote><p>X 兼容 Y：X(目标类型) =&gt; Y(源类型)</p></blockquote> <p>类型兼容性会出现在哪呢？广泛存在于 TS 中，但常出现在接口、类、函数中。</p> <h3 id="接口兼容"><a href="#接口兼容" class="header-anchor">#</a> 接口兼容</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">X</span></span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    b<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">Y</span></span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    b<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    c<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x<span class="token operator">:</span><span class="token constant">X</span> <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token operator">:</span><span class="token constant">Y</span> <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>问题来了， x 和 y 是否可以相互赋值？</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// yes</span>
y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>根据代码执行的结果我们知道，X 类型 兼容 Y 类型，即<strong>成员少的可以兼容成员多的</strong>。</p> <h3 id="函数兼容"><a href="#函数兼容" class="header-anchor">#</a> 函数兼容</h3> <p>函数兼容就是函数之前是否可以相互赋值，常出现在高阶函数中。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">hoc</span> <span class="token punctuation">(</span>handler<span class="token operator">:</span> Handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> handler<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">hoc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>函数的兼容比较复杂，分为下面几种情况：</p> <ul><li>参数的个数</li> <li>参数的类型</li> <li>返回值类型</li></ul> <h4 id="函数参数个数"><a href="#函数参数个数" class="header-anchor">#</a> 函数参数个数</h4> <p>参数个数：多的可以兼容少的。</p> <h5 id="只有固定参数情况下"><a href="#只有固定参数情况下" class="header-anchor">#</a> 只有固定参数情况下</h5> <p>目标函数的固定参数个数一定是大于等于待传参数的：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function">hoc</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// yes</span>
<span class="token function">hoc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//yes</span>
<span class="token function">hoc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> z<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="固定参数、可选参数和剩余参数"><a href="#固定参数、可选参数和剩余参数" class="header-anchor">#</a> 固定参数、可选参数和剩余参数</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> p2<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> p2<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">c</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>rest<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>固定参数可以兼容可选和剩余参数的。</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>a <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token comment">// yes</span>
a <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token comment">// yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>可选参数不兼容固定和剩余参数的。</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>b <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment">// no</span>
b <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>不过你可以通过 <code>tsconfig.json</code> 中的 <code>&quot;strictFunctionTypes&quot;: false,</code> 来让 b 兼容 a 和 c。</p> <ul><li>剩余参数可以兼容可选和固定参数的。</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>c <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment">// yes</span>
c <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token comment">// yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="函数参数的类型"><a href="#函数参数的类型" class="header-anchor">#</a> 函数参数的类型</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">PeopleOne</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">PeopleTwo</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">xiaoming</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ins<span class="token operator">:</span> PeopleOne<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">honghong</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ins<span class="token operator">:</span> PeopleTwo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>把接口的个数看成，函数的参数，就变成了参数多的兼容参数少的。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>honghong <span class="token operator">=</span> xiaoming<span class="token punctuation">;</span> <span class="token comment">// yes</span>
xiaoming <span class="token operator">=</span> honghong<span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>函数参数的之间可以相互赋值，叫函数参数的** **。避免了函数的断言。</p> <h4 id="函数返回值类型"><a href="#函数返回值类型" class="header-anchor">#</a> 函数返回值类型</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;shanshu&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;shanshu&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">90</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>函数返回值类型遵循<strong>少兼容多</strong> 和鸭式辨型法。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>f <span class="token operator">=</span> g<span class="token punctuation">;</span> <span class="token comment">// yes</span>
g <span class="token operator">=</span> f<span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="函数的重载"><a href="#函数的重载" class="header-anchor">#</a> 函数的重载</h4> <p>为了便于理解，可以认为<strong>重载列表</strong>是<strong>目标函数</strong>，函数的实现是<strong>源函数</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">overload</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">overload</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">overload</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意两点，函数的实现，参数个数不能超过目标函数，且返回值正确。</p> <h3 id="枚举类型的兼容"><a href="#枚举类型的兼容" class="header-anchor">#</a> 枚举类型的兼容</h3> <p>数字枚举和数字类型互相兼容：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">enum</span> Month <span class="token punctuation">{</span>
    Jan<span class="token punctuation">,</span>
    Feb<span class="token punctuation">,</span>
    Mar
<span class="token punctuation">}</span>

<span class="token keyword">let</span> num0<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> Month<span class="token punctuation">.</span>Jan<span class="token punctuation">;</span>
<span class="token keyword">let</span> num1<span class="token operator">:</span> Month<span class="token punctuation">.</span>Jan <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> no<span class="token operator">:</span> Month<span class="token punctuation">.</span>Jan <span class="token operator">=</span> Month<span class="token punctuation">.</span>Feb<span class="token punctuation">;</span> <span class="token comment">// 枚举之间不兼容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="类类型的兼容"><a href="#类类型的兼容" class="header-anchor">#</a> 类类型的兼容</h3> <p>静态成员和构造函数不参与比较。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>
<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span>
    id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">static</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token punctuation">{</span>
    id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    age <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">static</span> b <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">B</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token comment">// yes</span>
b <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment">// No</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>和接口差不多，**少兼容多。**注意，如果有私有（private|protected）属性，只有父类和子类相互兼容。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span>
    id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">static</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> abc <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">C</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
c <span class="token operator">=</span> a<span class="token punctuation">;</span>
a <span class="token operator">=</span> c<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="泛型兼容"><a href="#泛型兼容" class="header-anchor">#</a> 泛型兼容</h3> <h4 id="泛型接口"><a href="#泛型接口" class="header-anchor">#</a> 泛型接口</h4> <p>在两个泛型参数类型不相同时，只有在泛型参数使用时才出现兼容性。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Empty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> obj1<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj2<span class="token operator">:</span> Empty<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj1 <span class="token operator">=</span> obj2<span class="token punctuation">;</span> <span class="token comment">// yes</span>
obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span> <span class="token comment">// yes</span>

<span class="token keyword">interface</span> <span class="token class-name">Empty<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

obj1 <span class="token operator">=</span> obj2<span class="token punctuation">;</span> <span class="token comment">// no</span>
obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span> <span class="token comment">// no</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="泛型函数"><a href="#泛型函数" class="header-anchor">#</a> 泛型函数</h4> <p>泛型函数的<strong>定义</strong>是可以相同的。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">log1</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">log2</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>y<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

log1 <span class="token operator">=</span> log2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>结构之间兼容：成员少兼容成员多。<br>
函数之间兼容：参数多兼容参数少。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">6/21/2021, 7:52:49 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-ts-vuepress/get-started/generic-type.html" class="prev">
        泛型
      </a></span> <span class="next"><a href="/learn-ts-vuepress/get-started/advance-type.html">
        高级类型
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/learn-ts-vuepress/assets/js/app.e5df6003.js" defer></script><script src="/learn-ts-vuepress/assets/js/2.a63e5f2f.js" defer></script><script src="/learn-ts-vuepress/assets/js/32.fb15d45c.js" defer></script>
  </body>
</html>
